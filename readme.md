# mutator
mutator - это моя реализация решения задачи генерации программы на основе генетического алгоритма.

## StackLang
Для реализации простой логики, разработан маленький язык StackLang, который состоит из небольшого набора команд:

- push - положить число 0 в стек
- pop - вытолкнуть число из стека
- neg - вытолкнуть число из стека, умножить его на -1 и положить результат в стек
- xor - сложить два числа на вершине стека по модулю 2, и положить результат в стек
- add - сложить два числа на вершине стека, и положить результат в стек
- xorp - xor, но выталкиваем аргументы из стека
- addp - add, но выталкиваем аргументы из стека
- shlp - логический сдвиг влево числа на вершине стека
- shrp - логический сдвиг вправо числа на вершине стека
- inc - увеличить число на вершине стека на 1
- dec - уменьшить число на вершине стека на 1
- swap - обменять местами два числа на вершине стека
- copy - скопировать число на вершине стека и положить его в стек

Интерпретатор языка StackLang получает на вход начальное состояние стека и набор команд (программу), а при выполнении возвращает финальное состояние стека.

## Генетический алгоритм
Генетический алгоритм используется для оценки наиболее точно выполняющих задачу программ на языке StackLang.
Отбираются наиболее точные программы, которые в дальнейшем мутируются одним из следуюших способов:

1. Добавление новой команды в программу
2. Удаление команды из программы
3. Замена команды на другую
4. Смена порядка команд в программе

Полученные программы заново оцениваются и цикл повторяется до достижения максимального числа итераций.

## Оценка программы
Оценка работы программы оценивается по нескольким критериям

1. Наиболее важным критерием является наличие ошибок при выполнении программы. Если программа не выполняется, то она считается неудачной и не участвует в дальнейшем процессе генерации.
2. Расхождение между требуемым конечным состоянием стека и полученным. Чем меньше расхождение, тем лучше.
3. Количество команд в программе. Чем меньше команд, тем лучше.
4. Разность между размером стека в начале и в конце программы. Чем меньше разность, тем лучше. Используется в ходе отбора программ для приближения программы к требуемому конечному состоянию стека.

## Запуск
Для запуска программы необходимо выполнить команду `python3 main.py` в корневой директории проекта и указать через запятую искомое финальное состояние стека, например `python3 main.py 1,2,3`
Помимо этого, можно указать следующие параметры:

- --start - начальное состояние стека, по умолчанию пустой стек
- --iter - максимальное количество итераций генетического алгоритма, по умолчанию 1000
- --take - количество программ, которые будут отобраны для мутации, по умолчанию 10
- --step - количество шагов, после которых будет происходить вывод промежуточных результатов, по умолчанию 100
- -e или --exec - выполнить программу, полученную в результате работы генетического алгоритма
- -v или --verbose - выводить промежуточные результаты во время работы генетического алгоритма

## Примеры
Команда: ` python3 .\main.py 10,20,30 --start=40 -e`
Результат:

```bash
Running genetic algorithm with parameters:
Start stack: [40]
Target stack: [10, 20, 30]
Number of iterations: 1000
Number of programs to take: 10
Number of iterations between output: 100
Best program: ['shrp', 'copy', 'shrp', 'swap', 'xor']
Best result: [10, 20, 30]
When expected: [10, 20, 30]
Error: 0
Distance: 0
Length: 5
Diff: 0
Total score: 40
Executing best program:
Start stack: [40]
shrp: [20]
copy: [20, 20]
shrp: [20, 10]
swap: [10, 20]
xor: [10, 20, 30]
```